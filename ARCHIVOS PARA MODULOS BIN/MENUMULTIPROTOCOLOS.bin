#!/bin/bash


on(){
	set_autoport
	systemctl start filebrowser &>/dev/null
	ufw allow $port_f/tcp &>/dev/null
	if [[ $(systemctl is-enabled filebrowser) = 'disabled' ]]; then
		systemctl enable filebrowser &>/dev/null
	fi
	print_center -verd "filebrowser iniciado!!!"
}

off(){
	systemctl stop filebrowser &>/dev/null
	if [[ $(systemctl is-enabled filebrowser) = 'enabled' ]]; then
		systemctl disable filebrowser &>/dev/null
	fi
	print_center -ama "filebrowser detenido!!!"
}

on_off_file(){
	sta=$(systemctl is-active filebrowser)
	case $sta in
		active)off;;
		failed|inactive)on;;
	esac
	enter

menu_file(){
	install_path="/usr/local/bin"
	if [[ ! -d $install_path ]]; then
		install_path="/usr/bin"
	fi

	title "PANEL MULTIHERRAMIENTAS"
	nu=1
	if [[ -e "$install_path/MULTIHERRAMIENTAS" ]]; then

		std='\e[1m\e[31m[OFF]'
		if [[ $(systemctl is-active filebrowser) = 'active' ]]; then
			msg -bar
			std='\e[1m\e[32m[ON]'
		fi
		echo " $(msg -verd '[1]') $(msg -verm2 '>') $(msg -verm2 'MENU V2RAY')" && de="$nu"; in='a'
		echo -e " $(msg -verd '[2]') $(msg -verm2 '>') $(msg -verd 'MENU UDP')$(msg -ama '/')$(msg -verm2 'DETENER') $std"
		echo " $(msg -verd '[3]') $(msg -verm2 '>') $(msg -azu 'REINICIAR')"
		msg -bar3
		echo " $(msg -verd '[4]') $(msg -verm2 '>') $(msg -ama 'MODIFICAR NOMBRE DE USUARIO')"
		echo " $(msg -verd '[5]') $(msg -verm2 '>') $(msg -ama 'MODIFICAR CONTRASEÃ‘A')"
		msg -bar3
		echo " $(msg -verd '[6]') $(msg -verm2 '>') $(msg -verd 'ACTIVAR')$(msg -ama '/')$(msg -verm2 'DESACTIVAR') $(msg -azu 'ACCESO ROOT')" && nu=6
	else
		echo " $(msg -verd '[1]') $(msg -verm2 '>') $(msg -verd 'INSTALAR FILEBROWSER')" && in="$nu"; de='a'
	fi
	back
	opcion=$(selection_fun $nu)
	case $opcion in
		    1)install_file;;
		    2) bash <(curl -sL https://raw.githubusercontent.com/jorgevps10/modulosbin/main/MODULOS%20BIN%20HELLBOY/menuudp.bin);;
			3)on_off_file;;
			4)reload_file;;
			5)set_name_user;;
			6)set_pass;;
			7)act_root;;
			0)return 1;;
	esac
}

while [[  $? -eq 0 ]]; do
	menu_file
done